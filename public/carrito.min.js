class Carrito{comprarProducto(e){e.preventDefault(),e.target.classList.contains("agregar-carrito")&&this.leerDatosProducto(e.target.parentElement)}leerDatosProducto(e){const t={imagen:e.querySelector("img").src,titulo:e.querySelector("h5").textContent,precio:e.querySelector(".precio").textContent,id:e.querySelector("a").getAttribute("data-id"),cantidad:1};let o;o=this.obtenerProductosLocalStorage(),o.forEach(function(e){e.id===t.id&&(o=e.id)}),o===t.id?Swal.fire({icon:"warning",title:"No tenemos stock suficiente, prueba con menos unidades",timer:2500,showConfirmButton:!1}):(this.insertarCarrito(t),Swal.fire({icon:"success",title:"Agregado",timer:2500,showConfirmButton:!1}))}insertarCarrito(e){const t=document.createElement("tr");t.innerHTML=`\n        <td>\n        <img src="${e.imagen}" width=100>\n        </td>\n        <td>${e.titulo}</td>\n        <td>${e.precio}</td>\n        <td>\n        <a href="#" class="borrar-producto fas fa-times-circle" data-id="${e.id}"></a>\n        </td>\n        `,listaProductos.appendChild(t),this.guardarProductosLocalStorage(e)}eliminarProducto(e){e.preventDefault();let t,o;e.target.classList.contains("borrar-producto")&&(e.target.parentElement.parentElement.remove(),t=e.target.parentElement.parentElement,o=t.querySelector("a").getAttribute("data-id"),Swal.fire({icon:"info",title:"Eliminado",timer:2500,showConfirmButton:!1})),this.eliminarProductoLocalStorage(o),this.calcularTotal()}vaciarCarrito(e){for(e.preventDefault();listaProductos.firstChild;)listaProductos.removeChild(listaProductos.firstChild),Swal.fire({icon:"info",title:"Carrito Vacío",timer:2500,showConfirmButton:!1});return this.vaciarLocalStorage(),!1}guardarProductosLocalStorage(e){let t;t=this.obtenerProductosLocalStorage(),t.push(e),localStorage.setItem("productos",JSON.stringify(t))}obtenerProductosLocalStorage(){let e;return e=null===localStorage.getItem("productos")?[]:JSON.parse(localStorage.getItem("productos"))}eliminarProductoLocalStorage(e){let t;t=this.obtenerProductosLocalStorage(),t.forEach(function(o,r){o.id===e&&t.splice(r,1)}),localStorage.setItem("productos",JSON.stringify(t))}leerLocalStorage(){let e;e=this.obtenerProductosLocalStorage(),e.forEach(function(e){const t=document.createElement("tr");t.innerHTML=`\n            <td>\n            <img src="${e.imagen}" width=100>\n            </td>\n            <td>${e.titulo}</td>\n            <td>${e.precio}</td>\n            <td>\n            <a href="#" class="borrar-producto fas fa-times-circle" data-id="${e.id}"></a>\n            </td>\n            `,listaProductos.appendChild(t)})}leerLocalStorageCompra(){let e;e=this.obtenerProductosLocalStorage(),e.forEach(function(e){const t=document.createElement("tr");t.innerHTML=`\n            <td>\n            <img src="${e.imagen}" width=100>\n            </td>\n            <td>${e.titulo}</td>\n            <td>${e.precio}</td>\n            <td>${e.cantidad}</td>\n            <td>${e.precio*e.cantidad}</td>\n            <td>\n            <a href="#" class="borrar-producto fas fa-times-circle" data-id="${e.id}"></a>\n            </td>\n            `,listaCompra.appendChild(t)})}vaciarLocalStorage(){localStorage.clear()}procesarPedido(e){e.preventDefault(),0===this.obtenerProductosLocalStorage().length?Swal.fire({icon:"error",title:"El carrito está vacío, agrega un producto",timer:2500,showConfirmButton:!1}):location.href="carrito.html"}calcularTotal(){let e,t=0,o=0,r=0;e=this.obtenerProductosLocalStorage();for(let o=0;o<e.length;o++){let r=Number(e[o].precio*e[o].cantidad);t+=r}r=parseFloat(.18*t).toFixed(2),o=parseFloat(t-r).toFixed(2),document.getElementById("subtotal").innerHTML="S/. "+o,document.getElementById("igv").innerHTML="S/. "+r,document.getElementById("total").value="S/. "+t.toFixed(2)}}
